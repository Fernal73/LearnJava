#! /usr/bin/env bash

######################################################################
# @author      : Linus Fernandes (linusfernandes@gmail.com)
# @file        : run
# @created     : Thursday May 02, 2019 16:31:33 IST
# @copyright   : Copyright (c) Linus Fernandes
# @description : 
######################################################################
proj=$1
if [ -z $2 ]
then
  main=$(<$proj/.main)
else
  main=$2
fi
echo Main class: $main
setUp ()
{
	cd $proj
	[ -e setup ] && { ./setup; }
	cd ..
}
tearDown ()
{
	cd $proj
	[ -e teardown ] && { ./teardown; }
	cd ..
}
setUp
[ -e $proj.dex ] && { dalvikvm -cp $proj.dex $main;tearDown;exit 0; }
[ -e $proj.jar ] && { java -cp $proj.jar $main;tearDown;exit 0; }
usage ()
{
  echo 'Usage: run <dir> <class>'
  echo 'dir - project directory'
  echo 'class - full name including package name of the main class. Overrides contents of .main under project directory.'
  exit 1
}
usage
